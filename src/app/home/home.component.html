<div id="home">
    <div style="padding:5px 30px;">
        <ng-container>
            <!-- <div>
                <button type="button" class="btn btn-outline-primary ms-2"
                    (click)="isCollapsed = !isCollapsed">搜尋設定</button>
            </div> -->
            <!--搜尋設定-->
            <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed" style="margin-top:10px;">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <select class="form-select" aria-label="伺服器">
                                    @for (item of searchOptions.serverOptions; track $index) {
                                    <option>{{ item }}</option>
                                    }
                                </select>
                            </div>
                            <div class="col-6">
                                <select class="form-select" aria-label="聯盟">
                                    @for (item of searchOptions.leagues.options; track $index) {
                                    <option [selected]="item.text == searchOptions.leagues.chosenL">{{ item.text }}
                                    </option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="OnlineflexSwitchCheckChecked"
                                        [checked]="searchOptions.isOnline"
                                        (click)="searchOptions.isOnline = !searchOptions.isOnline">
                                    <label class="form-check-label" for="OnlineflexSwitchCheckChecked">只顯示線上</label>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="PricedflexSwitchCheckChecked"
                                        [checked]="searchOptions.isPriced"
                                        (click)="searchOptions.isPriced = !searchOptions.isPriced">
                                    <label class="form-check-label" for="PricedflexSwitchCheckChecked">有標價</label>
                                </div>
                            </div>
                            <div class="col-5">
                                <select class="form-select" aria-label="價格">
                                    @for (item of searchOptions.priceSetting.options; track $index) {
                                    <option [selected]="searchOptions.priceSetting.chosenObj.label == item.label">{{
                                        item.label }}</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="AccountflexSwitchCheckChecked"
                                        [checked]="searchOptions.isPriceCollapse"
                                        (click)="searchOptions.isPriceCollapse = !searchOptions.isPriceCollapse">
                                    <label class="form-check-label" for="AccountflexSwitchCheckChecked">依帳號摺疊</label>
                                </div>
                            </div>
                            <div class="col-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="CorruptedflexSwitchCheckChecked"
                                        [checked]="searchOptions.corruptedSet.isSearch"
                                        (click)="searchOptions.corruptedSet.isSearch = !searchOptions.corruptedSet.isSearch">
                                    <label class="form-check-label" for="CorruptedflexSwitchCheckChecked">已汙染</label>
                                </div>
                            </div>
                            <div class="col-5">
                                <select class="form-select" aria-label="已汙染"
                                    [disabled]="!searchOptions.corruptedSet.isSearch">
                                    @for (item of searchOptions.corruptedSet.options; track $index) {
                                    <option [selected]="searchOptions.corruptedSet.chosenObj.label == item.label">{{
                                        item.label }}</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--物品搜尋-->
            <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed" style="margin-top:10px;">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="ItemLevelflexSwitchCheckChecked"
                                        [checked]="searchOptions.itemLevel.isSearch"
                                        (click)="searchOptions.itemLevel.isSearch = !searchOptions.itemLevel.isSearch">
                                    <label class="form-check-label" for="ItemLevelflexSwitchCheckChecked">物品等級</label>
                                </div>
                            </div>
                            <div class="col-1">
                                <input type="text" aria-label="min" class="form-control"
                                    [value]="searchOptions.itemLevel.min"
                                    [disabled]="!searchOptions.itemLevel.isSearch">
                            </div>
                            <div class="col-1">
                                <input type="text" aria-label="max" class="form-control"
                                    [value]="searchOptions.itemLevel.max"
                                    [disabled]="!searchOptions.itemLevel.isSearch">
                            </div>
                            <div class="col-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="RaritySetflexSwitchCheckChecked"
                                        [checked]="searchOptions.raritySet.isSearch"
                                        (click)="searchOptions.raritySet.isSearch = !searchOptions.raritySet.isSearch">
                                    <label class="form-check-label" for="RaritySetflexSwitchCheckChecked">稀有度</label>
                                </div>
                            </div>
                            <div class="col-3">
                                <select class="form-select" aria-label="稀有度"
                                    [disabled]="!searchOptions.raritySet.isSearch">
                                    @for (item of searchOptions.raritySet.option; track $index) {
                                    <option value="{{ item.prop }}"
                                        [selected]="searchOptions.raritySet.chosenObj.label == item.label">{{ item.label
                                        }}</option>
                                    }
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox"
                                        id="ItemCategoryflexSwitchCheckChecked"
                                        [checked]="searchOptions.itemCategory.isSearch"
                                        (click)="searchOptions.itemCategory.isSearch = !searchOptions.itemCategory.isSearch">
                                    <label class="form-check-label"
                                        for="ItemCategoryflexSwitchCheckChecked">物品分類</label>
                                </div>
                            </div>
                            <div class="col-2">
                                <select class="form-select" aria-label="物品分類"
                                    [disabled]="!searchOptions.itemCategory.isSearch">
                                    @for (item of searchOptions.itemCategory.option; track $index) {
                                    <option value="{{ item.prop }}"
                                        [selected]="searchOptions.itemCategory.chosenObj.label == item.label">{{
                                        item.label }}</option>
                                    }
                                </select>
                            </div>
                            <div class="col-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="ItemBasicflexSwitchCheckChecked"
                                        [checked]="searchOptions.itemBasic.isSearch"
                                        [(ngModel)]="searchOptions.itemBasic.isSearch"
                                        (click)="searchOptions.itemBasic.isSearch = !searchOptions.itemBasic.isSearch">
                                    <label class="form-check-label" for="ItemBasicflexSwitchCheckChecked">物品基底</label>
                                </div>
                            </div>
                            <div class="col-4">
                                <input type="text" class="form-control" placeholder="物品基底" aria-label="物品基底"
                                    [value]="searchOptions.itemBasic.text" disabled="true">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--換界石搜尋-->
            <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed" style="margin-top:10px;">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-3">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="MapLevelflexSwitchCheckChecked"
                                        [checked]="searchOptions.mapLevel.isSearch"
                                        (click)="searchOptions.mapLevel.isSearch = !searchOptions.mapLevel.isSearch">
                                    <label class="form-check-label" for="MapLevelflexSwitchCheckChecked">階級</label>
                                </div>
                            </div>
                            <div class="col-1">
                                <input type="text" aria-label="min" class="form-control"
                                    [value]="searchOptions.mapLevel.min" [disabled]="!searchOptions.mapLevel.isSearch">
                            </div>
                            <div class="col-1">
                                <input type="text" aria-label="max" class="form-control"
                                    [value]="searchOptions.mapLevel.max" [disabled]="!searchOptions.mapLevel.isSearch">
                            </div>
                            <div class="col-4">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox"
                                        id="_RaritySetflexSwitchCheckChecked"
                                        [checked]="searchOptions.raritySet.isSearch"
                                        (click)="searchOptions.raritySet.isSearch = !searchOptions.raritySet.isSearch">
                                    <label class="form-check-label" for="_RaritySetflexSwitchCheckChecked">稀有度</label>
                                </div>
                            </div>
                            <div class="col-3">
                                <select class="form-select" aria-label="稀有度"
                                    [disabled]="!searchOptions.raritySet.isSearch">
                                    @for (item of searchOptions.raritySet.option; track $index) {
                                    <option value="{{ item.prop }}"
                                        [selected]="searchOptions.raritySet.chosenObj.label == item.label">{{ item.label
                                        }}</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--技能寶石搜尋-->
            <div #collapse="ngbCollapse" [(ngbCollapse)]="isCollapsed" style="margin-top:10px;">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-2">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox" id="GemLevelflexSwitchCheckChecked"
                                        [checked]="searchOptions.gemLevel.isSearch"
                                        (click)="searchOptions.gemLevel.isSearch = !searchOptions.gemLevel.isSearch">
                                    <label class="form-check-label" for="GemLevelflexSwitchCheckChecked">等級</label>
                                </div>
                            </div>
                            <div class="col-2">
                                <input type="text" aria-label="min" class="form-control"
                                    [value]="searchOptions.gemLevel.min" [disabled]="!searchOptions.gemLevel.isSearch">
                            </div>
                            <div class="col-2">
                                <input type="text" aria-label="max" class="form-control"
                                    [value]="searchOptions.gemLevel.max" [disabled]="!searchOptions.gemLevel.isSearch">
                            </div>
                            <div class="col-2">
                                <div class="form-check form-switch">
                                    <input class="form-check-input" type="checkbox"
                                        id="GemQualityflexSwitchCheckChecked"
                                        [checked]="searchOptions.gemQuality.isSearch"
                                        (click)="searchOptions.gemQuality.isSearch = !searchOptions.gemQuality.isSearch">
                                    <label class="form-check-label" for="GemQualityflexSwitchCheckChecked">品質</label>
                                </div>
                            </div>
                            <div class="col-2">
                                <input type="text" aria-label="min" class="form-control"
                                    [value]="searchOptions.gemQuality.min"
                                    [disabled]="!searchOptions.gemQuality.isSearch">
                            </div>
                            <div class="col-2">
                                <input type="text" aria-label="max" class="form-control"
                                    [value]="searchOptions.gemQuality.max"
                                    [disabled]="!searchOptions.gemQuality.isSearch">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--詞綴搜尋-->
            <h5 [innerHTML]="item.name" style="text-align: center; cursor: pointer;padding-top: 6px;"
                (click)="ui.collapse.stats = !ui.collapse.stats"></h5>
            <div #collapse="ngbCollapse" [(ngbCollapse)]="ui.collapse.stats" style="margin-top:10px;">
                <div class="card">
                    <div class="card-body">
                        <div class="row">
                            <div class="col">
                                <table class="table" id="stets">
                                    <thead>
                                        <tr>
                                            <th scope="col" style="width: 50px;">查詢</th>
                                            <th scope="col" style="width: 55px;">種類</th>
                                            <th scope="col">詞綴內容</th>
                                            <th scope="col" style="width: 70px;">最小值</th>
                                            <th scope="col" style="width: 70px;">最大值</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @for (stat of item.searchStats; track $index) {
                                        <tr>
                                            <td
                                                [ngStyle]="{'backgroundColor': stat.isSearch ? 'rgba(254, 224, 85, 0.5)' : '#FFFFFF'}">
                                                @if (stat.id !== '') {
                                                <div class="form-check">
                                                    <input class="form-check-input" name="ststsChecked" type="checkbox"
                                                        [(ngModel)]="stat.isSearch"
                                                        [id]="'StstsflexCheckDefault_' + $index">
                                                    <label class="form-check-label"
                                                        [for]="'StstsflexCheckDefault_' + $index">
                                                    </label>
                                                </div>
                                                }
                                                @else {
                                                <b style="cursor: pointer;" placement="top" ngbTooltip="無法解析詞綴">?</b>
                                                }
                                            </td>
                                            <td
                                                [ngStyle]="{'background': stat.isSearch ? 'rgba(254, 224, 85, 0.5)' : '#FFFFFF'}">
                                                {{
                                                stat.type }}
                                            </td>
                                            <td (click)="stat.isSearch = !stat.isSearch"
                                                style="white-space:pre-wrap;cursor: pointer;"
                                                [ngStyle]="{'background': stat.isSearch ? 'rgba(254, 224, 85, 0.5)' : '#FFFFFF', 'color': (stat.id=='') ? 'red' : '#000000'}">
                                                {{
                                                stat.text }}
                                            </td>
                                            <td
                                                [ngStyle]="{'background': stat.isSearch ? 'rgba(254, 224, 85, 0.5)' : '#FFFFFF'}">
                                                <div>
                                                    <input type="text" class="form-control" aria-label="min"
                                                        [(ngModel)]="stat.min" value="{{ stat.min }}">
                                                </div>
                                            </td>
                                            <td
                                                [ngStyle]="{'background': stat.isSearch ? 'rgba(254, 224, 85, 0.5)' : '#FFFFFF'}">
                                                <div>
                                                    <input type="text" class="form-control" aria-label="max"
                                                        [(ngModel)]="stat.max" value="{{ stat.max }}">
                                                </div>
                                            </td>
                                        </tr>
                                        }
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </ng-container>
        <!--之後做-->
        <div id="search" style="text-align: center;">
            <button (click)="clickToSearch()">搜尋</button>
        </div>
    </div>
</div>
<hr>
@if (searchResult.searchTotal > 0) {
<h6 [innerHTML]="searchResult.status" style="padding-top: 10px;text-align: center;"></h6>
<div style="text-align: center;"><button (click)="popOfficialWebsite()" type="button"
        class="btn btn-outline-primary">台服官方交易市集</button></div>
<app-analyze [searchResult]="searchResult"></app-analyze>
}